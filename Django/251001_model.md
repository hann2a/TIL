# 1. Django 모델(Model)

- Django에서 데이터베이스와 상호작용하는 기본 단위.
- 모든 모델은 django.db.models.Model을 상속받아 정의됨.

- 예시:
```python 
class Article(models.Model):
    title = models.CharField(max_length=100)
    content = models.TextField()
```
→ DB에 article 테이블이 생성되고 title, content 필드가 컬럼으로 추가됨.

# 2. Abstract Base Classes (추상 기본 클래스)

- DB에 직접 테이블을 만들지 않음.
- 공통 필드/메서드를 재사용할 때 상속받아 사용.
- 하위 클래스에 기능이 포함됨.

- 예시:
```python 
class TimeStampedModel(models.Model):
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)

    class Meta:
        abstract = True   # 테이블 생성 안 됨

class Post(TimeStampedModel):
    title = models.CharField(max_length=100)
```
→ DB에는 post 테이블만 생성, created_at, updated_at 필드가 포함됨.

# 3. AbstractBaseUser

- Django 인증 시스템의 최소 뼈대 클래스.
- 비밀번호, 로그인 관련 최소 기능만 제공.
- 모든 것을 직접 정의할 때 사용.
```python 
from django.contrib.auth.models import AbstractBaseUser
```

# 4. AbstractUser
- AbstractBaseUser를 상속한 추상 User 클래스.
- username, email, is_staff, is_superuser 등 일반적인 사용자 필드 포함.
- 새로운 필드만 추가해서 쉽게 확장 가능.

- 예시:
```python 
from django.contrib.auth.models import AbstractUser

class CustomUser(AbstractUser):
    nickname = models.CharField(max_length=30, unique=True)
```

# 5. User

- Django가 기본 제공하는 실제 User 모델.
- AbstractUser를 구체화한 것.
- 별도의 Custom User를 만들지 않으면 이 모델이 사용됨.

# 6. Custom User Model (커스텀 사용자 모델)

- 프로젝트 성격에 맞는 User 모델을 직접 정의할 수 있음.
- 초기 프로젝트 시작 시 설정하는 것이 가장 안전함.

# 6-1. 왜 필요할까?

- username 대신 email로 로그인 하고 싶을 때
- 사용자에게 nickname, birth_date 같은 추가 정보가 필요할 때
- 추후 확장성을 위해 기본 User를 그대로 쓰지 않고 싶을 때

# 6-2. 구현 방식
## (1) AbstractUser 상속 (가장 흔한 방법)

→ 기본 필드 유지하면서 추가 필드만 정의
```python 
# accounts/models.py
from django.contrib.auth.models import AbstractUser
from django.db import models

class CustomUser(AbstractUser):
    nickname = models.CharField(max_length=30, unique=True)
    birth_date = models.DateField(null=True, blank=True)
```

## (2) AbstractBaseUser 상속 (고급 방법)

→ 모든 필드를 직접 설계해야 함. 인증 관련 기능도 직접 지정 필요.
```python 
# accounts/models.py
from django.contrib.auth.models import AbstractBaseUser, BaseUserManager
from django.db import models

class CustomUserManager(BaseUserManager):
    def create_user(self, email, password=None, **extra_fields):
        if not email:
            raise ValueError("이메일은 필수입니다.")
        email = self.normalize_email(email)
        user = self.model(email=email, **extra_fields)
        user.set_password(password)
        user.save(using=self._db)
        return user

    def create_superuser(self, email, password=None, **extra_fields):
        extra_fields.setdefault('is_staff', True)
        extra_fields.setdefault('is_superuser', True)
        return self.create_user(email, password, **extra_fields)


class CustomUser(AbstractBaseUser):
    email = models.EmailField(unique=True)
    nickname = models.CharField(max_length=30, unique=True)

    is_active = models.BooleanField(default=True)
    is_staff = models.BooleanField(default=False)

    objects = CustomUserManager()

    USERNAME_FIELD = 'email'   # 로그인 ID를 email로 사용
    REQUIRED_FIELDS = ['nickname']
```
# 6-3. 설정

settings.py에 반드시 추가:
```python 
AUTH_USER_MODEL = 'accounts.CustomUser'
```

# ✅ 정리

작은 변경만 필요 → AbstractUser 상속

완전히 커스텀 필요 → AbstractBaseUser 상속